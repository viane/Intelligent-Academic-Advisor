'use strict';

var express = require('express');

var router = express.Router();

var vcapServices = require('vcap_services'),
    extend = require('util')._extend,
    watson = require('watson-developer-cloud');

var config = extend({
  version: 'v1',
  url: 'https://stream.watsonplatform.net/speech-to-text/api',
  username: '110115fe-46e5-42cd-a5c3-41a09be09375',
  password: 'UA8PfTGKRr60'
}, vcapServices.getCredentials('speech_to_text'));

var authService = watson.authorization(config);

// set up an endpoint to serve speech-to-text auth tokens

router.post('/token', function (req, res, next) {
  authService.getToken({ url: config.url }, function (err, token) {
    if (err) {
      throw err;
      res.status(500).send('Error retrieving token');
      return;
    } else {
      res.send(token);
    }
  });
});

module.exports = router;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9zeXN0ZW0vd2F0c29uL3Rva2VuLmpzIl0sIm5hbWVzIjpbImV4cHJlc3MiLCJyZXF1aXJlIiwicm91dGVyIiwiUm91dGVyIiwidmNhcFNlcnZpY2VzIiwiZXh0ZW5kIiwiX2V4dGVuZCIsIndhdHNvbiIsImNvbmZpZyIsInZlcnNpb24iLCJ1cmwiLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwiZ2V0Q3JlZGVudGlhbHMiLCJhdXRoU2VydmljZSIsImF1dGhvcml6YXRpb24iLCJwb3N0IiwicmVxIiwicmVzIiwibmV4dCIsImdldFRva2VuIiwiZXJyIiwidG9rZW4iLCJzdGF0dXMiLCJzZW5kIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUEsSUFBSUEsVUFBVUMsUUFBUSxTQUFSLENBQWQ7O0FBRUEsSUFBSUMsU0FBU0YsUUFBUUcsTUFBUixFQUFiOztBQUVBLElBQUlDLGVBQWVILFFBQVEsZUFBUixDQUFuQjtBQUFBLElBQ0lJLFNBQWVKLFFBQVEsTUFBUixFQUFnQkssT0FEbkM7QUFBQSxJQUVJQyxTQUFlTixRQUFRLHdCQUFSLENBRm5COztBQUlBLElBQUlPLFNBQVNILE9BQU87QUFDbEJJLFdBQVMsSUFEUztBQUVsQkMsT0FBSyxzREFGYTtBQUdsQkMsWUFBVSxzQ0FIUTtBQUlsQkMsWUFBVTtBQUpRLENBQVAsRUFLVlIsYUFBYVMsY0FBYixDQUE0QixnQkFBNUIsQ0FMVSxDQUFiOztBQU9BLElBQUlDLGNBQWNQLE9BQU9RLGFBQVAsQ0FBcUJQLE1BQXJCLENBQWxCOztBQUVBOztBQUVBTixPQUFPYyxJQUFQLENBQVksUUFBWixFQUFzQixVQUFVQyxHQUFWLEVBQWVDLEdBQWYsRUFBb0JDLElBQXBCLEVBQTBCO0FBQzlDTCxjQUFZTSxRQUFaLENBQXFCLEVBQUNWLEtBQUtGLE9BQU9FLEdBQWIsRUFBckIsRUFBd0MsVUFBU1csR0FBVCxFQUFjQyxLQUFkLEVBQXFCO0FBQzNELFFBQUlELEdBQUosRUFBUTtBQUNOLFlBQU1BLEdBQU47QUFDQUgsVUFBSUssTUFBSixDQUFXLEdBQVgsRUFBZ0JDLElBQWhCLENBQXFCLHdCQUFyQjtBQUNBO0FBQ0QsS0FKRCxNQUtJO0FBQ0ZOLFVBQUlNLElBQUosQ0FBU0YsS0FBVDtBQUNEO0FBQ0YsR0FURDtBQVVELENBWEQ7O0FBYUFHLE9BQU9DLE9BQVAsR0FBaUJ4QixNQUFqQiIsImZpbGUiOiJ0b2tlbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0J1xuXG52YXIgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTtcblxudmFyIHJvdXRlciA9IGV4cHJlc3MuUm91dGVyKCk7XG5cbnZhciB2Y2FwU2VydmljZXMgPSByZXF1aXJlKCd2Y2FwX3NlcnZpY2VzJyksXG4gICAgZXh0ZW5kICAgICAgID0gcmVxdWlyZSgndXRpbCcpLl9leHRlbmQsXG4gICAgd2F0c29uICAgICAgID0gcmVxdWlyZSgnd2F0c29uLWRldmVsb3Blci1jbG91ZCcpO1xuXG52YXIgY29uZmlnID0gZXh0ZW5kKHtcbiAgdmVyc2lvbjogJ3YxJyxcbiAgdXJsOiAnaHR0cHM6Ly9zdHJlYW0ud2F0c29ucGxhdGZvcm0ubmV0L3NwZWVjaC10by10ZXh0L2FwaScsXG4gIHVzZXJuYW1lOiAnMTEwMTE1ZmUtNDZlNS00MmNkLWE1YzMtNDFhMDliZTA5Mzc1JyxcbiAgcGFzc3dvcmQ6ICdVQThQZlRHS1JyNjAnXG59LCB2Y2FwU2VydmljZXMuZ2V0Q3JlZGVudGlhbHMoJ3NwZWVjaF90b190ZXh0JykpO1xuXG52YXIgYXV0aFNlcnZpY2UgPSB3YXRzb24uYXV0aG9yaXphdGlvbihjb25maWcpO1xuXG4vLyBzZXQgdXAgYW4gZW5kcG9pbnQgdG8gc2VydmUgc3BlZWNoLXRvLXRleHQgYXV0aCB0b2tlbnNcblxucm91dGVyLnBvc3QoJy90b2tlbicsIGZ1bmN0aW9uIChyZXEsIHJlcywgbmV4dCkge1xuICBhdXRoU2VydmljZS5nZXRUb2tlbih7dXJsOiBjb25maWcudXJsfSwgZnVuY3Rpb24oZXJyLCB0b2tlbikge1xuICAgIGlmIChlcnIpe1xuICAgICAgdGhyb3cgZXJyO1xuICAgICAgcmVzLnN0YXR1cyg1MDApLnNlbmQoJ0Vycm9yIHJldHJpZXZpbmcgdG9rZW4nKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZWxzZXtcbiAgICAgIHJlcy5zZW5kKHRva2VuKTtcbiAgICB9XG4gIH0pO1xufSlcblxubW9kdWxlLmV4cG9ydHMgPSByb3V0ZXJcbiJdfQ==