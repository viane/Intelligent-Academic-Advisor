'use strict';

var watson = require('watson-developer-cloud');
var qs = require('qs'); //  Use a querystring parser to encode output.

var retrieve_and_rank = watson.retrieve_and_rank({ username: 'a658754c-09f3-4cc4-a8a1-198a25cd295e', password: 'KTldeBICAwNp', version: 'v1' });

var rrparams = {
    cluster_id: 'scd1a4815e_895b_4a51_b8da_239255267abd',
    collection_name: 'Intelligent-Academic-Planner-Collection'
};

var solrClient = retrieve_and_rank.createSolrClient(rrparams);

var ranker_id = '1eec74x28-rank-4480';

exports.enterMessage = function (inputText, questionTopic) {
    return new Promise(function (resolve, reject) {
        var rrquery = qs.stringify({ q: inputText, ranker_id: ranker_id, rows: 10, fl: 'id,answer_id,score,ranker.confidence,title,body' });
        //ask retrive and rank
        solrClient.get('fcselect', rrquery, function (err, searchResponse) {
            if (err) {
                console.error(err);
                reject(err);
            } else {
                resolve(searchResponse);
            }
        });
    });
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9zeXN0ZW0vd2F0c29uL3JldHJpZXZlLXJhbmsuanMiXSwibmFtZXMiOlsid2F0c29uIiwicmVxdWlyZSIsInFzIiwicmV0cmlldmVfYW5kX3JhbmsiLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwidmVyc2lvbiIsInJycGFyYW1zIiwiY2x1c3Rlcl9pZCIsImNvbGxlY3Rpb25fbmFtZSIsInNvbHJDbGllbnQiLCJjcmVhdGVTb2xyQ2xpZW50IiwicmFua2VyX2lkIiwiZXhwb3J0cyIsImVudGVyTWVzc2FnZSIsImlucHV0VGV4dCIsInF1ZXN0aW9uVG9waWMiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsInJycXVlcnkiLCJzdHJpbmdpZnkiLCJxIiwicm93cyIsImZsIiwiZ2V0IiwiZXJyIiwic2VhcmNoUmVzcG9uc2UiLCJjb25zb2xlIiwiZXJyb3IiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBLElBQU1BLFNBQVNDLFFBQVEsd0JBQVIsQ0FBZjtBQUNBLElBQU1DLEtBQUtELFFBQVEsSUFBUixDQUFYLEMsQ0FBMEI7O0FBRTFCLElBQU1FLG9CQUFvQkgsT0FBT0csaUJBQVAsQ0FBeUIsRUFBQ0MsVUFBVSxzQ0FBWCxFQUFtREMsVUFBVSxjQUE3RCxFQUE2RUMsU0FBUyxJQUF0RixFQUF6QixDQUExQjs7QUFFQSxJQUFNQyxXQUFXO0FBQ2JDLGdCQUFZLHdDQURDO0FBRWJDLHFCQUFpQjtBQUZKLENBQWpCOztBQUtBLElBQU1DLGFBQWFQLGtCQUFrQlEsZ0JBQWxCLENBQW1DSixRQUFuQyxDQUFuQjs7QUFFQSxJQUFNSyxZQUFZLHFCQUFsQjs7QUFFQUMsUUFBUUMsWUFBUixHQUF1QixVQUFTQyxTQUFULEVBQW9CQyxhQUFwQixFQUFtQztBQUN0RCxXQUFPLElBQUlDLE9BQUosQ0FBWSxVQUFTQyxPQUFULEVBQWtCQyxNQUFsQixFQUEwQjtBQUN6QyxZQUFNQyxVQUFVbEIsR0FBR21CLFNBQUgsQ0FBYSxFQUFDQyxHQUFHUCxTQUFKLEVBQWVILFdBQVdBLFNBQTFCLEVBQXFDVyxNQUFNLEVBQTNDLEVBQStDQyxJQUFJLGlEQUFuRCxFQUFiLENBQWhCO0FBQ0E7QUFDQWQsbUJBQVdlLEdBQVgsQ0FBZSxVQUFmLEVBQTJCTCxPQUEzQixFQUFvQyxVQUFTTSxHQUFULEVBQWNDLGNBQWQsRUFBOEI7QUFDOUQsZ0JBQUlELEdBQUosRUFBUztBQUNMRSx3QkFBUUMsS0FBUixDQUFjSCxHQUFkO0FBQ0FQLHVCQUFPTyxHQUFQO0FBQ0gsYUFIRCxNQUdPO0FBQ0hSLHdCQUFRUyxjQUFSO0FBQ0g7QUFDSixTQVBEO0FBUUgsS0FYTSxDQUFQO0FBWUgsQ0FiRCIsImZpbGUiOiJyZXRyaWV2ZS1yYW5rLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnXG5cbmNvbnN0IHdhdHNvbiA9IHJlcXVpcmUoJ3dhdHNvbi1kZXZlbG9wZXItY2xvdWQnKTtcbmNvbnN0IHFzID0gcmVxdWlyZSgncXMnKTsgLy8gIFVzZSBhIHF1ZXJ5c3RyaW5nIHBhcnNlciB0byBlbmNvZGUgb3V0cHV0LlxuXG5jb25zdCByZXRyaWV2ZV9hbmRfcmFuayA9IHdhdHNvbi5yZXRyaWV2ZV9hbmRfcmFuayh7dXNlcm5hbWU6ICdhNjU4NzU0Yy0wOWYzLTRjYzQtYThhMS0xOThhMjVjZDI5NWUnLCBwYXNzd29yZDogJ0tUbGRlQklDQXdOcCcsIHZlcnNpb246ICd2MSd9KTtcblxuY29uc3QgcnJwYXJhbXMgPSB7XG4gICAgY2x1c3Rlcl9pZDogJ3NjZDFhNDgxNWVfODk1Yl80YTUxX2I4ZGFfMjM5MjU1MjY3YWJkJyxcbiAgICBjb2xsZWN0aW9uX25hbWU6ICdJbnRlbGxpZ2VudC1BY2FkZW1pYy1QbGFubmVyLUNvbGxlY3Rpb24nXG59O1xuXG5jb25zdCBzb2xyQ2xpZW50ID0gcmV0cmlldmVfYW5kX3JhbmsuY3JlYXRlU29sckNsaWVudChycnBhcmFtcyk7XG5cbmNvbnN0IHJhbmtlcl9pZCA9ICcxZWVjNzR4MjgtcmFuay00NDgwJztcblxuZXhwb3J0cy5lbnRlck1lc3NhZ2UgPSBmdW5jdGlvbihpbnB1dFRleHQsIHF1ZXN0aW9uVG9waWMpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGNvbnN0IHJycXVlcnkgPSBxcy5zdHJpbmdpZnkoe3E6IGlucHV0VGV4dCwgcmFua2VyX2lkOiByYW5rZXJfaWQsIHJvd3M6IDEwLCBmbDogJ2lkLGFuc3dlcl9pZCxzY29yZSxyYW5rZXIuY29uZmlkZW5jZSx0aXRsZSxib2R5J30pO1xuICAgICAgICAvL2FzayByZXRyaXZlIGFuZCByYW5rXG4gICAgICAgIHNvbHJDbGllbnQuZ2V0KCdmY3NlbGVjdCcsIHJycXVlcnksIGZ1bmN0aW9uKGVyciwgc2VhcmNoUmVzcG9uc2UpIHtcbiAgICAgICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlc29sdmUoc2VhcmNoUmVzcG9uc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KTtcbn1cbiJdfQ==