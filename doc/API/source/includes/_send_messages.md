# Send Messages (Questions)

We implement Watson Conversation System with Retrivement and Rank to get a smooth conversation.

## Send a Message in Lite Version

### HTTP Request

`post /questions/send-lite`

> To get an answer to a question or start a conversation, use this code:

```javascript
fetch("http://localhost:3000/questions/send-lite", {  
  method: 'post',  
  headers: {  
    "Content-type": "application/json"
  },
  body: JSON.stringify({
        'question': '',
        'context' : {}
  })
}).then(response=>{return response.json()})
.then(json=> {
  //json contains responses
})
```

The "send-lite" API requires 2 parameter in the request body

Parameter          | Description
------------------ | --------------------------------------
question           | A question should be in the request body
context            | A context is an object generated by server to track a conversation.

<aside class="notice">
For the first post, the context is an empty object. Then, it should be the same with the one from server.
</aside>

<aside class="notice">
The response are either with useful information or the request to restate a question.
</aside>

### Example response of successful response from Retrive and Rank:

```json
// retrieve_and_rank response
{
    "context":{},
    "responseHeader": {
        "status": 0,
        "QTime": 45
    },
    "response": {
        "numFound": 518,
        "start": 0,
        "maxScore": 10,
        "docs": [
            {
                "id": "9241ae96-add9-4746-bda1-84960b7a105b",
                "title": "Help me explain the difference between studying Computer Engineering and Electrical Engineering.",
                "body": "An electrical engineer is someone who designs and develops new electrical equipment, solves problems and tests equipment. They work with all kinds of electronic devices, from the smallest pocket devices to large supercomputers. Electrical engineering deals with electricity, electro-magnetism and electronics.[\\n] Computer engineering is the branch of engineering that integrates electronic engineering with computer sciences. Computer engineers design and develop computer systems and other technological devices[\\n] Electrical Engineering encompasses Computer Engineering. An Electrical Engineer can do a Computer Engineers work, but in some cases Computer Engineer can’t work with core electrical stuff. There are even available courses with can help Electrical engineers to get jobs in IT industry but you hardly find any courses which helps Computer Engineers to get jobs in the electrical field.",
                "score": 10,
                "ranker.confidence": 0.5462427822233803
            },
            ...
            {
                "id": "a327393a-a7cc-4c71-8383-8525b58bbc88",
                "title": "no-title",
                "body": "Computer engineering majors complete several courses to fulfill various categories while pursuing a bachelor’s degree. In addition to general education courses, students also must successfully complete electrical engineering, computer engineering, general computer and mathematical, and computer engineering elective courses.[\\n] [extend]In many programs, the core computer engineering curriculum includes calculus, engineering analysis, and physics. Electrical engineering courses include electronic circuits, signals and systems, electrical engineering design, and logic design. Computer engineering courses often include computer architecture, digital system design, microcomputer systems, and C++. Other computer-based coursework could include probability, random processes, and computer programming with engineering. The range of electives varies greatly by program and institution, but common courses include operating systems, Unix, network security, and software engineering.[\\n][/extend]  ",
                "score": 1,
                "ranker.confidence": 0
            }
        ]
    }
}
```

Property                    | Description
-------------------------   | --------------------------------
res.context                 | A Conversation track needed to send back
res.response.docs           | An array of responses
res.response.numFound       | Total number of found responses 
res.response.maxScore       | The maximum score of a response


### Example response 1 from Conversaton:

```json
// conversation response for asking personal information
{
    "context": {
        "conversation_id": "2c1b0e4c-9ffd-4713-9172-b3bbde8d799d",
        "system": {
            "dialog_stack": [
                "slot_34_1500798544935"
            ],
            "dialog_turn_counter": 1,
            "dialog_request_counter": 1,
            "_node_output_map": {}
        },
        "Semester": "next semester"
    },
    "response": {
        "docs": [
            {
                "title": "Conversation continue",
                "body": [
                    "Could you provide me with your PSU ID to look up your schedule?"
                ]
            }
        ]
    }
}
```

Property                    | Description
-------------------------   | --------------------------------
res.response.docs           | An array of responses
res.context                 | An object track the conversation need to be sent back to server

### Example response 2 from Conversaton:

```json
// conversation response to show query result
{
    "context": {},
    "response": {
        "docs": [
            {
                "title": "personal question information",
                "body": "-schedule -semester next semester -psu_id 960625319"
            }
        ]
    }
}
```

Property                    | Description
-------------------------   | --------------------------------
res.response.docs           | An array of responses
res.context                 | An object track the conversation need to be sent back to server

### Example response for unsolved question:

```json
// response to show question is unsolved
{
    "response": {
        "docs": [
            {
                "title": "No answer found",
                "body": "Sorry I can't find any answer for this question, please ask a different question."
            }
        ]
    },
    "context": {}
}
```

Property                    | Description
-------------------------   | --------------------------------
res.response.docs           | An array of responses
res.context                 | An object track the conversation need to be sent back to server



## Send a Message in Full Version

### HTTP Request

`post /questions/send`

> To get an answer to a question or start a conversation, use this code:

```javascript
fetch("http://localhost:3000/questions/send", {  
  method: 'post',  
  headers: {  
    "Content-type": "application/json",
    "x-access-token":"{user's token}"
  },
  body: JSON.stringify({
        'question': ''(question),
        'context' : {} (context obejct)
  })
}).then(response=>{return response.json()})
.then(json=> {
  //json contains responses
})

```
The "send" API requires 2 parameter in the request body

Parameter          | Description
------------------ | --------------------------------------
question           | A question should be in the request body
context            | A context is an object generated by server to track a conversation.

The "send" API requires 1 parameter in the request header

Parameter          | Description
------------------ | --------------------------------------
x-access-token     | Token gained after successfully signin

<aside class="notice">
For the first post, the context is an empty object. Then, it should be the same with the one from server.
</aside>

<aside class="notice">
The response are either with useful information or the request to restate a question.
</aside>

### Example response of successful response from Retrive and Rank:

```json
// retrieve_and_rank response
{
    "context":{},
    "responseHeader": {
        "status": 0,
        "QTime": 45
    },
    "response": {
        "numFound": 518,
        "start": 0,
        "maxScore": 10,
        "docs": [
            {
                "id": "9241ae96-add9-4746-bda1-84960b7a105b",
                "title": "Help me explain the difference between studying Computer Engineering and Electrical Engineering.",
                "body": "An electrical engineer is someone who designs and develops new electrical equipment, solves problems and tests equipment. They work with all kinds of electronic devices, from the smallest pocket devices to large supercomputers. Electrical engineering deals with electricity, electro-magnetism and electronics.[\\n] Computer engineering is the branch of engineering that integrates electronic engineering with computer sciences. Computer engineers design and develop computer systems and other technological devices[\\n] Electrical Engineering encompasses Computer Engineering. An Electrical Engineer can do a Computer Engineers work, but in some cases Computer Engineer can’t work with core electrical stuff. There are even available courses with can help Electrical engineers to get jobs in IT industry but you hardly find any courses which helps Computer Engineers to get jobs in the electrical field.",
                "score": 10,
                "ranker.confidence": 0.5462427822233803
            },
            ...
            {
                "id": "a327393a-a7cc-4c71-8383-8525b58bbc88",
                "title": "no-title",
                "body": "Computer engineering majors complete several courses to fulfill various categories while pursuing a bachelor’s degree. In addition to general education courses, students also must successfully complete electrical engineering, computer engineering, general computer and mathematical, and computer engineering elective courses.[\\n] [extend]In many programs, the core computer engineering curriculum includes calculus, engineering analysis, and physics. Electrical engineering courses include electronic circuits, signals and systems, electrical engineering design, and logic design. Computer engineering courses often include computer architecture, digital system design, microcomputer systems, and C++. Other computer-based coursework could include probability, random processes, and computer programming with engineering. The range of electives varies greatly by program and institution, but common courses include operating systems, Unix, network security, and software engineering.[\\n][/extend]  ",
                "score": 1,
                "ranker.confidence": 0
            }
        ]
    }
}
```

Property                    | Description
-------------------------   | --------------------------------
res.context                 | A Conversation track
res.response.docs           | An array of responses
res.response.numFound       | Total number of found responses 
res.response.maxScore       | The maximum score of a response


### Example response 1 from Conversaton:

```json
// conversation response for asking personal information
{
    "context": {
        "conversation_id": "2c1b0e4c-9ffd-4713-9172-b3bbde8d799d",
        "system": {
            "dialog_stack": [
                "slot_34_1500798544935"
            ],
            "dialog_turn_counter": 1,
            "dialog_request_counter": 1,
            "_node_output_map": {}
        },
        "Semester": "next semester"
    },
    "response": {
        "docs": [
            {
                "title": "Conversation continue",
                "body":"Could you provide me with your PSU ID to look up your schedule?"
            }
        ]
    }
}
```

Property                    | Description
-------------------------   | --------------------------------
res.response.docs           | An array of responses
res.context                 | An object track the conversation needed to be sent back to server

### Example response 2 from Conversaton:

```json
// conversation response to show query result
{
    "context": {},
    "response": {
        "docs": [
            {
                "title": "personal question information",
                "body": "-schedule -semester 4 -psu_id 960623452"
            }
        ]
    }
}
```

Property                    | Description
-------------------------   | --------------------------------
res.response.docs           | An array of responses
res.context                 | An object track the conversation need to be sent back to server

### Example response for unsolved question:

```json
// response to show question is unsolved
{
    "response": {
        "docs": [
            {
                "title": "No answer found",
                "body": "Sorry I can't find any answer for this question, please ask a different question."
            }
        ]
    },
    "context": {}
}
```

Property                    | Description
-------------------------   | --------------------------------
res.response.docs           | An array of responses
res.context                 | An object track the conversation

## Post a Question in Lite Version

### HTTP Request

`post /questions/ask-lite`

> To get an answer to a question, use this code:

```javascript
fetch("http://localhost:3000/questions/ask-lite", {  
  method: 'post',  
  headers: {  
    "Content-type": "application/x-www-form-urlencoded; charset=UTF-8"
  },
  body: 'question={question}',
  credentials: 'include'
}).then(response=>{return response.json()})
.then(json=> {
  // now json contains answers
});
```

The sign in API requires 1 parameter in the request body

Parameter          | Description
------------------ | --------------------------------------
question           | A question should be in the request body


<aside class="notice">
The response are either with useful information or the request to restate a question.
</aside>

### Example response of successful response from retrive and rank:

```json
// retrieve_and_rank response
{
    "responseHeader": {
        "status": 0,
        "QTime": 45
    },
    "response": {
        "numFound": 518,
        "start": 0,
        "maxScore": 10,
        "docs": [
            {
                "id": "9241ae96-add9-4746-bda1-84960b7a105b",
                "title": "Help me explain the difference between studying Computer Engineering and Electrical Engineering.",
                "body": "An electrical engineer is someone who designs and develops new electrical equipment, solves problems and tests equipment. They work with all kinds of electronic devices, from the smallest pocket devices to large supercomputers. Electrical engineering deals with electricity, electro-magnetism and electronics.[\\n] Computer engineering is the branch of engineering that integrates electronic engineering with computer sciences. Computer engineers design and develop computer systems and other technological devices[\\n] Electrical Engineering encompasses Computer Engineering. An Electrical Engineer can do a Computer Engineers work, but in some cases Computer Engineer can’t work with core electrical stuff. There are even available courses with can help Electrical engineers to get jobs in IT industry but you hardly find any courses which helps Computer Engineers to get jobs in the electrical field.",
                "score": 10,
                "ranker.confidence": 0.5462427822233803
            },
            ...
            {
                "id": "a327393a-a7cc-4c71-8383-8525b58bbc88",
                "title": "no-title",
                "body": "Computer engineering majors complete several courses to fulfill various categories while pursuing a bachelor’s degree. In addition to general education courses, students also must successfully complete electrical engineering, computer engineering, general computer and mathematical, and computer engineering elective courses.[\\n] [extend]In many programs, the core computer engineering curriculum includes calculus, engineering analysis, and physics. Electrical engineering courses include electronic circuits, signals and systems, electrical engineering design, and logic design. Computer engineering courses often include computer architecture, digital system design, microcomputer systems, and C++. Other computer-based coursework could include probability, random processes, and computer programming with engineering. The range of electives varies greatly by program and institution, but common courses include operating systems, Unix, network security, and software engineering.[\\n][/extend]  ",
                "score": 1,
                "ranker.confidence": 0
            }
        ]
    }
}
```

Property                    | Description
-------------------------   | --------------------------------
res.response.docs           | An array of answers
res.response.numFound       | Total number of found answers 
res.response.maxScore       | The maximum score of an answer 



## Post a Question in Full Version

### HTTP Request

`post /questions/ask`

> To get answers to a question, use this code:

```javascript
fetch("http://localhost:3000/questions/ask", {  
  method: 'post',  
  headers: {  
    "Content-type": "application/x-www-form-urlencoded; charset=UTF-8",
    "x-access-token":"{user's token}"
  },
  body: 'question={question}',
  credentials: 'include'
}).then(response=>{return response.json()})
.then(json=> {
  // now json contains answers
});
```
The sign in API requires 1 parameter in the request body

Parameter          | Description
------------------ | --------------------------------------
question           | A question should be in the request body

The sign in API requires 1 parameter in the request header

Parameter          | Description
------------------ | --------------------------------------
x-access-token     | Token gained after successfully signin

<aside class="notice">
The response are either success or error due to invalid token.
</aside>

### Example response of error:

```json
// error due to incorrect token
{
    "message": "You are not authenticated!",
    "error": {
        "status": 302
    }
}
```

Property     | Eesponse                            | Description
------------ | ----------------------------------- | ---------------
message      | You are not authenticated!          | User signin token is invalid
error.status | 302                                 | Indicate user should be redirected to signin page

### Example response of successful signin:

```json
// retrieve_and_rank response
{
    "responseHeader": {
        "status": 0,
        "QTime": 70
    },
    "response": {
        "numFound": 358,
        "start": 0,
        "maxScore": 10,
        "docs": [
            {
                "id": "1ffc75ca-b123-4b0f-9d70-8a3104302320",
                "title": "no-title",
                "body": "Undergraduate degrees in computer science include several categories of courses. Many in the first years of an undergraduate degree prepare students for advanced course work in the computer science major. These courses often include basic computer applications, discrete mathematics, calculus, and algorithms in addition to basic computer science courses such as introduction to computer science. [\\n] [extend] Major course work includes several types of classes in computer science. Students complete computer science courses in programming, information technology, applications and web development, operating systems, and data communications. Examples of specific courses include java programming, data structures, management information systems, business data communication, and web development. Specialized courses might also include security, forensics, and health informatics. [\\n] See [a]recommend course schedule[/a] from Penn State Behrend to find out more about your question. [\\n][/extend] [link]http://rap.psu.edu/computer-science-cmpbd[/link]",
                "score": 10,
                "ranker.confidence": 0.5415041751929232
            },
            ...
            {
                "id": "06071de8-8e3b-4a03-9d5f-f13ff26d106f",
                "title": "no-title",
                "body": "Computer forensic specialists must have a knowledge base in networking, programming, encryption and computer science. They need to be able to take the data and evidence they obtain from technological systems and use it to compile strong evidence to present in court and other official capacities. Thus, getting a job in forensics with a computer science degree is absolutely possible. [extend] The level of degree required to work in computer forensics varies with the type of job, work setting and responsibility involved. Some entry level positions with law enforcement agencies require only an associate’s degree in computer forensics, computer science or other comprehensive computer area of study. Other kinds of jobs often ask for a bachelor’s degree in computer science, information technology or similar subject matter. Educational experience in computer engineering may be required for upper level jobs, such as those in the federal government. [/extend]  ",
                "score": 1,
                "ranker.confidence": 0
            }
        ]
    }
}
```
Property                    | Description
-------------------------   | --------------------------------
res.response.docs           | An array of answers
res.response.numFound       | Total number of found answers 
res.response.maxScore       | The maximum score of an answer 